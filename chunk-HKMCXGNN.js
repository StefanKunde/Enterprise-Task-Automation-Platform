import{b as G}from"./chunk-SZEIPOXG.js";import{b as F,c as p,d as L,e as V,g as K,h as N,i as P,j as q,k as A,n as D,o as Q,p as j}from"./chunk-MNG2DFIP.js";import"./chunk-B2LUGKIE.js";import{C as _,D as b,Ja as k,N as a,Na as h,P as f,Q as R,R as I,U as u,Wa as J,Y as m,Ya as M,Za as T,aa as r,ba as i,bb as v,ca as g,fa as O,ga as x,ha as c,ma as o,oa as C,qa as Y,ra as Z,sa as H,w as S,z as U}from"./chunk-6P7KIDLQ.js";function ne(e,l){if(e&1&&(r(0,"div",21),o(1),i()),e&2){let t=c();a(),C(" ",t.successMessage," ")}}function oe(e,l){e&1&&(r(0,"div",22)(1,"button",23),o(2," Forgot password? (Disabled) "),i()())}function le(e,l){if(e&1&&(r(0,"div",24),o(1),i()),e&2){let t=c();a(),C(" ",t.error," ")}}function se(e,l){e&1&&(r(0,"div",29),o(1," A new verification link has been sent to your email. "),i())}function ae(e,l){e&1&&(r(0,"div",30),o(1," Something went wrong. Please try again later. "),i())}function me(e,l){if(e&1){let t=O();r(0,"div",25)(1,"button",26),x("click",function(){_(t);let s=c();return b(s.resendVerification())}),o(2," \u2709 Resend verification email "),i(),u(3,se,2,0,"div",27)(4,ae,2,0,"div",28),i()}if(e&2){let t=c();a(3),m("ngIf",t.resendSuccess),a(),m("ngIf",t.resendError)}}function de(e,l){e&1&&(r(0,"div",40),o(1," If this email exists, a reset link has been sent. "),i())}function ue(e,l){e&1&&(r(0,"div",41),o(1," Failed to send email. Please try again later. "),i())}function ce(e,l){if(e&1){let t=O();r(0,"div",31),x("click",function(){_(t);let s=c();return b(s.closeResetModal())}),r(1,"div",32),x("click",function(s){return _(t),b(s.stopPropagation())}),r(2,"button",33),x("click",function(){_(t);let s=c();return b(s.closeResetModal())}),o(3,"\xD7"),i(),r(4,"h3",34),o(5,"Reset your password"),i(),r(6,"p",35),o(7,"Enter your email address and we\u2019ll send you a reset link."),i(),r(8,"input",36),H("ngModelChange",function(s){_(t);let d=c();return Z(d.resetEmail,s)||(d.resetEmail=s),b(s)}),i(),r(9,"button",37),o(10," Password Reset Disabled (Demo Only) "),i(),u(11,de,2,0,"div",38)(12,ue,2,0,"div",39),i()()}if(e&2){let t=c();a(8),Y("ngModel",t.resetEmail),a(3),m("ngIf",t.resetEmailSent),a(),m("ngIf",t.resetError)}}var y=class e{constructor(l,t,n){this.auth=l;this.router=t;this.route=n;this.form=this.fb.group({email:["",[p.required,p.email]],password:["",p.required]})}form;loading=!1;error=null;unverifiedEmail=!1;resendSuccess=!1;resendError=!1;showForgotPassword=!1;showResetModal=!1;resetEmail="";resetEmailSent=!1;resetError=!1;fb=U(D);successMessage=null;ngOnInit(){this.route.queryParams.subscribe(l=>{l.message==="merge-success"&&(this.successMessage="Accounts successfully merged. Please log in again.")})}submit(){if(this.form.invalid)return;this.loading=!0,this.error=null;let{email:l,password:t}=this.form.value;this.auth.login(l,t).subscribe({next:()=>{this.router.navigate(["/dashboard"])},error:n=>{console.log("err: ",n);let s=n?.error?.error?.message?.toLowerCase()||"";console.log("message:",s),n?.error?.error?.statusCode===403&&s.includes("not been verified")?(this.unverifiedEmail=!0,this.error="Please confirm your email address."):this.error="Login failed",this.loading=!1}})}resendVerification(){this.auth.resendVerificationEmail(this.form.value.email).subscribe({next:()=>{this.resendSuccess=!0,this.resendError=!1},error:()=>{this.resendError=!0,this.resendSuccess=!1}})}openResetModal(){this.showResetModal=!0,this.resetEmailSent=!1,this.resetError=!1,this.resetEmail=this.form.value.email||""}closeResetModal(){this.showResetModal=!1}requestPasswordReset(){this.resetEmailSent=!1,this.resetError=!1,this.auth.requestPasswordReset(this.resetEmail).subscribe({next:()=>{this.resetEmailSent=!0},error:()=>{this.resetError=!0}})}static \u0275fac=function(t){return new(t||e)(f(G),f(M),f(J))};static \u0275cmp=R({type:e,selectors:[["app-login"]],decls:33,vars:6,consts:[[1,"bg-[#141C22]","text-white","px-4","py-12","flex","items-center","justify-center"],[1,"w-full","max-w-md","space-y-8"],[1,"bg-yellow-900/30","border","border-yellow-600/50","rounded-lg","p-4","text-center"],[1,"text-yellow-200","font-semibold"],[1,"text-yellow-300/80","text-sm","mt-1"],[1,"text-center"],[1,"text-2xl","font-bold"],[1,"text-sm","text-[#B6C2CF]"],["class","text-green-400 text-sm text-center mb-4",4,"ngIf"],[1,"bg-[#20272E]","rounded-2xl","p-6","space-y-6","shadow-lg",3,"ngSubmit","formGroup"],["for","email",1,"block","text-sm","font-medium","text-gray-300"],["formControlName","email","id","email","type","email","autocomplete","email username","required","",1,"mt-1","block","w-full","rounded-lg","bg-gray-700","border","border-gray-600","p-3","text-white","focus:outline-none","focus:ring-2","focus:ring-green-500"],["for","password",1,"block","text-sm","font-medium","text-gray-300"],["formControlName","password","id","password","type","password","autocomplete","current-password","required","",1,"mt-1","block","w-full","rounded-lg","bg-gray-700","border","border-gray-600","p-3","text-white","focus:outline-none","focus:ring-2","focus:ring-green-500"],["type","button","disabled","",1,"w-full","bg-gray-600","cursor-not-allowed","text-gray-400","font-semibold","py-3","rounded-xl","opacity-60"],["class","text-sm text-center",4,"ngIf"],["class","text-red-400 text-center text-sm pt-4",4,"ngIf"],["class","text-center mt-4",4,"ngIf"],[1,"text-sm","text-center","text-[#B6C2CF]","pt-6"],["routerLink","/auth/register",1,"text-green-400","hover:underline","cursor-pointer"],["class","fixed inset-0 backdrop-blur-sm bg-black/40 z-50 flex justify-center items-center px-4",3,"click",4,"ngIf"],[1,"text-green-400","text-sm","text-center","mb-4"],[1,"text-sm","text-center"],["type","button","disabled","",1,"text-gray-500","text-sm","mt-2","cursor-not-allowed"],[1,"text-red-400","text-center","text-sm","pt-4"],[1,"text-center","mt-4"],[1,"text-sm","text-green-400","hover:underline","hover:text-green-300","cursor-pointer",3,"click"],["class","text-green-400 text-sm mt-2",4,"ngIf"],["class","text-red-400 text-sm mt-2",4,"ngIf"],[1,"text-green-400","text-sm","mt-2"],[1,"text-red-400","text-sm","mt-2"],[1,"fixed","inset-0","backdrop-blur-sm","bg-black/40","z-50","flex","justify-center","items-center","px-4",3,"click"],[1,"bg-[#1C262E]","p-6","rounded-lg","w-full","max-w-md","text-white","relative","animate-fade-in","shadow-2xl","border","border-[#3DB34A]",3,"click"],[1,"absolute","top-3","right-3","text-gray-400","text-lg","hover:cursor-pointer",3,"click"],[1,"text-lg","font-bold","mb-2","text-center"],[1,"text-sm","text-gray-300","mb-4","text-center"],["placeholder","Your email address",1,"w-full","p-3","rounded-lg","bg-gray-700","border","border-gray-600","text-white","text-sm","mb-3",3,"ngModelChange","ngModel"],["type","button","disabled","",1,"w-full","bg-gray-600","cursor-not-allowed","text-gray-400","py-2","rounded-lg","font-semibold","text-sm","opacity-60"],["class","text-green-400 text-sm text-center mt-3",4,"ngIf"],["class","text-red-400 text-sm text-center mt-3",4,"ngIf"],[1,"text-green-400","text-sm","text-center","mt-3"],[1,"text-red-400","text-sm","text-center","mt-3"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),o(4,"\u26A0\uFE0F Portfolio Demo Only"),i(),r(5,"p",4),o(6,"This is a non-functional demonstration. Login is disabled."),i()(),r(7,"div",5)(8,"h2",6),o(9,"Welcome back to TaskFlow"),i(),r(10,"p",7),o(11,"Log in to access your dashboard"),i()(),u(12,ne,2,1,"div",8),r(13,"form",9),x("ngSubmit",function(){return n.submit()}),r(14,"div")(15,"label",10),o(16,"Email"),i(),g(17,"input",11),i(),r(18,"div")(19,"label",12),o(20,"Password"),i(),g(21,"input",13),i(),r(22,"div")(23,"button",14),o(24," Login Disabled (Demo Only) "),i()(),u(25,oe,3,0,"div",15)(26,le,2,1,"div",16)(27,me,5,2,"div",17),r(28,"div",18),o(29," No account yet? "),r(30,"a",19),o(31,"Register now"),i()()()()(),u(32,ce,13,3,"div",20)),t&2&&(a(12),m("ngIf",n.successMessage),a(),m("formGroup",n.form),a(12),m("ngIf",!n.unverifiedEmail),a(),m("ngIf",n.error),a(),m("ngIf",n.unverifiedEmail),a(5),m("ngIf",n.showResetModal))},dependencies:[h,k,j,N,F,L,V,A,P,q,v,T,Q,K],encapsulation:2})};function pe(e,l){e&1&&(r(0,"div"),o(1,"Email is required."),i())}function fe(e,l){e&1&&(r(0,"div"),o(1,"Invalid email address."),i())}function ge(e,l){if(e&1&&(r(0,"div",23),u(1,pe,2,0,"div",24)(2,fe,2,0,"div",24),i()),e&2){let t,n,s=c();a(),m("ngIf",(t=s.form.get("email"))==null||t.errors==null?null:t.errors.required),a(),m("ngIf",(n=s.form.get("email"))==null||n.errors==null?null:n.errors.email)}}function xe(e,l){e&1&&(r(0,"div"),o(1,"Username is required."),i())}function ve(e,l){if(e&1&&(r(0,"div",23),u(1,xe,2,0,"div",24),i()),e&2){let t,n=c();a(),m("ngIf",(t=n.form.get("username"))==null||t.errors==null?null:t.errors.required)}}function _e(e,l){e&1&&(r(0,"div"),o(1,"Password is required."),i())}function be(e,l){e&1&&(r(0,"div"),o(1,"Minimum 6 characters required."),i())}function he(e,l){e&1&&(r(0,"div"),o(1,"Must contain at least one letter and one number."),i())}function ye(e,l){if(e&1&&(r(0,"div",23),u(1,_e,2,0,"div",24)(2,be,2,0,"div",24)(3,he,2,0,"div",24),i()),e&2){let t,n,s,d=c();a(),m("ngIf",(t=d.form.get("password"))==null||t.errors==null?null:t.errors.required),a(),m("ngIf",(n=d.form.get("password"))==null||n.errors==null?null:n.errors.minlength),a(),m("ngIf",(s=d.form.get("password"))==null||s.errors==null?null:s.errors.pattern)}}function we(e,l){e&1&&(r(0,"div",23),o(1," Passwords do not match. "),i())}function Ce(e,l){if(e&1&&(r(0,"div",25),o(1),i()),e&2){let t=c();a(),C(" ",t.error," ")}}function Ee(e,l){e&1&&(r(0,"div",26),o(1," \u2705 You've successfully registered. Please check your inbox to verify your email address. "),i())}var w=class e{constructor(l,t,n){this.fb=l;this.auth=t;this.router=n;this.form=this.fb.group({email:["",[p.required,p.email]],username:["",p.required],password:["",[p.required,p.minLength(6),p.maxLength(128),p.pattern(/^(?=.*[A-Za-z])(?=.*\d).{6,}$/)]],confirmPassword:["",p.required]},{validators:this.passwordMatchValidator()})}form;loading=!1;error=null;emailVerificationNotice=!1;submit(){if(this.form.invalid)return;this.loading=!0,this.error=null;let{email:l,username:t,password:n}=this.form.value;localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),this.auth.register(l,n,t).subscribe({next:s=>{this.loading=!1,this.emailVerificationNotice=!0},error:s=>{console.log("err: ",s);let d=s?.error?.error?.message;console.log("backenderr msg: ",d),d==="Email is already in use."?this.error="This email is already registered.":d==="Username is already taken."?this.error="This username is already taken.":d==="Password must be at least 6 characters long."?this.error="Your password does not meet the requirements.":this.error="Registration failed. Please try again.",this.loading=!1,console.error(s)}})}passwordMatchValidator(){return l=>{let t=l.get("password")?.value,n=l.get("confirmPassword")?.value;return t===n?null:{mismatch:!0}}}static \u0275fac=function(t){return new(t||e)(f(D),f(G),f(M))};static \u0275cmp=R({type:e,selectors:[["app-register"]],decls:42,vars:7,consts:[[1,"bg-[#141C22]","text-white","px-4","py-12","flex","items-center","justify-center"],[1,"w-full","max-w-md","space-y-8"],[1,"bg-yellow-900/30","border","border-yellow-600/50","rounded-lg","p-4","text-center"],[1,"text-yellow-200","font-semibold"],[1,"text-yellow-300/80","text-sm","mt-1"],[1,"text-center"],[1,"text-2xl","font-bold"],[1,"text-sm","text-[#B6C2CF]"],[1,"bg-[#20272E]","rounded-2xl","p-6","space-y-6","shadow-lg","mt-4",3,"ngSubmit","formGroup"],["for","email",1,"block","text-sm","font-medium","text-gray-300"],["formControlName","email","id","email","type","email","autocomplete","email","required","",1,"mt-1","block","w-full","rounded-lg","bg-white","border","border-gray-300","p-3","text-black","focus:outline-none","focus:ring-2","focus:ring-green-500"],["class","text-red-400 text-sm mt-1",4,"ngIf"],["for","username",1,"block","text-sm","font-medium","text-gray-300"],["formControlName","username","id","username","type","text","required","",1,"mt-1","block","w-full","rounded-lg","bg-white","border","border-gray-300","p-3","text-black","focus:outline-none","focus:ring-2","focus:ring-green-500"],["for","password",1,"block","text-sm","font-medium","text-gray-300"],["formControlName","password","id","password","type","password","autocomplete","new-password","required","",1,"mt-1","block","w-full","rounded-lg","bg-white","border","border-gray-300","p-3","text-black","focus:outline-none","focus:ring-2","focus:ring-green-500"],["for","confirmPassword",1,"block","text-sm","font-medium","text-gray-300"],["formControlName","confirmPassword","id","confirmPassword","type","password","autocomplete","new-password","required","",1,"mt-1","block","w-full","rounded-lg","bg-white","border","border-gray-300","p-3","text-black","focus:outline-none","focus:ring-2","focus:ring-green-500"],["type","button","disabled","",1,"w-full","bg-gray-600","cursor-not-allowed","text-gray-400","font-semibold","py-3","rounded-xl","opacity-60"],["class","text-red-400 text-center text-sm pt-2",4,"ngIf"],["class","mt-6 text-sm text-green-400 bg-green-900/40 p-4 rounded-xl text-center shadow",4,"ngIf"],[1,"text-sm","text-center","text-[#B6C2CF]","pt-6"],["routerLink","/auth/login",1,"text-green-400","hover:underline","cursor-pointer"],[1,"text-red-400","text-sm","mt-1"],[4,"ngIf"],[1,"text-red-400","text-center","text-sm","pt-2"],[1,"mt-6","text-sm","text-green-400","bg-green-900/40","p-4","rounded-xl","text-center","shadow"]],template:function(t,n){if(t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),o(4,"\u26A0\uFE0F Portfolio Demo Only"),i(),r(5,"p",4),o(6,"This is a non-functional demonstration. Registration is disabled."),i()(),r(7,"div",5)(8,"h2",6),o(9,"Create your TaskFlow Account"),i(),r(10,"p",7),o(11,"Sign up to get started"),i()(),r(12,"form",8),x("ngSubmit",function(){return n.submit()}),r(13,"div")(14,"label",9),o(15,"Email"),i(),g(16,"input",10),u(17,ge,3,2,"div",11),i(),r(18,"div")(19,"label",12),o(20,"Username"),i(),g(21,"input",13),u(22,ve,2,1,"div",11),i(),r(23,"div")(24,"label",14),o(25,"Password"),i(),g(26,"input",15),u(27,ye,4,3,"div",11),i(),r(28,"div")(29,"label",16),o(30,"Confirm Password"),i(),g(31,"input",17),u(32,we,2,0,"div",11),i(),r(33,"div")(34,"button",18),o(35," Registration Disabled (Demo Only) "),i()(),u(36,Ce,2,1,"div",19),i(),u(37,Ee,2,0,"div",20),r(38,"div",21),o(39," Already have an account? "),r(40,"a",22),o(41,"Login here"),i()()()()),t&2){let s,d,E,z;a(12),m("formGroup",n.form),a(5),m("ngIf",((s=n.form.get("email"))==null?null:s.touched)&&((s=n.form.get("email"))==null?null:s.errors)),a(5),m("ngIf",((d=n.form.get("username"))==null?null:d.touched)&&((d=n.form.get("username"))==null?null:d.errors)),a(5),m("ngIf",((E=n.form.get("password"))==null?null:E.touched)&&((E=n.form.get("password"))==null?null:E.errors)),a(5),m("ngIf",(n.form.errors==null?null:n.form.errors.mismatch)&&((z=n.form.get("confirmPassword"))==null?null:z.touched)),a(4),m("ngIf",n.error),a(),m("ngIf",n.emailVerificationNotice)}},dependencies:[h,k,j,N,F,L,V,A,P,q,v,T],encapsulation:2})};var Se=[{path:"login",component:y},{path:"register",component:w}],B=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=I({type:e});static \u0275inj=S({imports:[v.forChild(Se),v]})};var X=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=I({type:e});static \u0275inj=S({imports:[h,B,y,w]})};export{X as AuthModule};
